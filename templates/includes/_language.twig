{# includes/_language.twig — a11y: fókuszkeret + opcionális aktív keret #}

{% set currentSite  = currentSite ?? craft.app.sites.currentSite %}
{% set sites        = craft.app.sites.getAllSites() %}
{% set entryObj     = (currentEntry is defined and currentEntry) ? currentEntry : null %}

<ul class="flex items-center gap-2 relative z-[60]" role="list">
  {% for site in sites %}
    {% set lang       = site.language ?? 'hu' %}
    {% set isCurrent  = (site.id == currentSite.id) %}
    {% set localized  = entryObj ? entryObj.getLocalized().site(site).one() : null %}
    {% set url        = localized ? localized.url : site.baseUrl %}

    <li>
      <a href="{{ url }}"
         lang="{{ lang }}"
         hreflang="{{ lang }}"
         class="inline-flex items-center pointer-events-auto transition
                {{ not isCurrent ? 'opacity-70 hover:opacity-100' : '' }}
                focus:outline-none
                focus-visible:outline focus-visible:outline-2 focus-visible:outline-white focus-visible:-outline-offset-2"
         {% if isCurrent %} aria-current="true"{% endif %}
         aria-label="{{ 'Nyelv: ' ~ lang|upper }}"
         title="{{ lang|upper }}">
        <img src="/images/{{ lang|lower }}.svg"
             alt=""
             aria-hidden="true"
             class="block h-[20px] w-auto m-0 p-0
                    {{ isCurrent ? 'outline outline-1 outline-white/70 -outline-offset-1' : '' }}">
        <span class="sr-only">{{ lang|upper }}</span>
      </a>
    </li>
  {% endfor %}
</ul>
